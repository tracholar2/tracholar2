
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>什么是NullReferenceException，如何解决？ | 智子</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="zhizi">
    

    
    <meta name="description" content="我有一些代码，当它执行时，它抛出一个NullReferenceException，说：  Object reference not set to an instance of an object.  这是什么意思，我该怎么办才能解决这个错误？">
<meta property="og:type" content="article">
<meta property="og:title" content="什么是NullReferenceException，如何解决？">
<meta property="og:url" content="https://www.tracholar.top/2018/01/19/what-is-a-nullreferenceexception-and-how-do-i-fix-it/index.html">
<meta property="og:site_name" content="智子">
<meta property="og:description" content="我有一些代码，当它执行时，它抛出一个NullReferenceException，说：  Object reference not set to an instance of an object.  这是什么意思，我该怎么办才能解决这个错误？">
<meta property="og:image" content="https://www.tracholar.top/2018/01/19/what-is-a-nullreferenceexception-and-how-do-i-fix-it/“https://i.stack.imgur.com/5ndSA.jpg”alt">
<meta property="og:image" content="https://www.tracholar.top/2018/01/19/what-is-a-nullreferenceexception-and-how-do-i-fix-it/“https://i.stack.imgur.com/E5d94.jpg”alt">
<meta property="og:image" content="https://www.tracholar.top/2018/01/19/what-is-a-nullreferenceexception-and-how-do-i-fix-it/“https://i.stack.imgur.com/5ndSA.jpg”alt">
<meta property="og:updated_time" content="2018-01-15T16:12:13.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="什么是NullReferenceException，如何解决？">
<meta name="twitter:description" content="我有一些代码，当它执行时，它抛出一个NullReferenceException，说：  Object reference not set to an instance of an object.  这是什么意思，我该怎么办才能解决这个错误？">
<meta name="twitter:image" content="https://www.tracholar.top/2018/01/19/what-is-a-nullreferenceexception-and-how-do-i-fix-it/“https://i.stack.imgur.com/5ndSA.jpg”alt">

    
    <link rel="alternative" href="/atom.xml" title="智子" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">

    <!-- ad start -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script>
  (adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-6300557868920774",
    enable_page_level_ads: true
  });
</script>

    <!-- ad end -->

    <!--  stat -->
    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?4036f580b1119e720db871571faa68cc";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-78529611-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-78529611-1');
</script>

    <!-- end stat -->
</head>

  <body>
    <header>
      
<div>
		
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="智子">智子</a></h1>
				<h2 class="blog-motto">智子之家</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.tracholar.top">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody">
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/19/what-is-a-nullreferenceexception-and-how-do-i-fix-it/" title="什么是NullReferenceException，如何解决？" itemprop="url">什么是NullReferenceException，如何解决？</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="zhizi" target="_blank" itemprop="author">zhizi</a>
		
  <p class="article-time">
    <time datetime="2018-01-19T01:22:34.000Z" itemprop="datePublished"> 发表于 2018-01-19</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">What is the cause?</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">Bottom Line</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">More Specifically</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">Debugging</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">Examples</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.1.</span> <span class="toc-text">Generic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.2.</span> <span class="toc-text">Class instances</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.3.</span> <span class="toc-text">Indirect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.4.</span> <span class="toc-text">Array</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.5.</span> <span class="toc-text">Array Elements</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.6.</span> <span class="toc-text">Jagged Arrays</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.7.</span> <span class="toc-text">Collection/List/Dictionary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.8.</span> <span class="toc-text">Range Variable (Indirect/Deferred)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.9.</span> <span class="toc-text">Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.10.</span> <span class="toc-text">Bad Naming Conventions:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.11.</span> <span class="toc-text">ASP.NET Page Life cycle:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.12.</span> <span class="toc-text">ASP.NET Session Values</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.13.</span> <span class="toc-text">ASP.NET MVC empty view models</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.14.</span> <span class="toc-text">WPF Control Creation Order and Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.15.</span> <span class="toc-text">Cast with as</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.16.</span> <span class="toc-text">LINQ FirstOrDefault() and SingleOrDefault()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.17.</span> <span class="toc-text">foreach</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">4.</span> <span class="toc-text">Ways to Avoid</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.1.</span> <span class="toc-text">Explicitly check for null and ignore null values.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.2.</span> <span class="toc-text">Explicitly check for null and provide a default value.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.3.</span> <span class="toc-text">Explicitly check for null from method calls and throw a custom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.4.</span> <span class="toc-text">Use Debug.Assert if a value should never be null, to catch the problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.5.</span> <span class="toc-text">Use GetValueOrDefault() for nullable value types to provide a default</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.6.</span> <span class="toc-text">Use the null coalescing operator: ?? [C#] or If() [VB].</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.7.</span> <span class="toc-text">Use the null condition operator: ?. (available in C# 6 and VB.NET 14):</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">5.</span> <span class="toc-text">NullReference Exception a Visual Basic</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.1.</span> <span class="toc-text">Basic Meaning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.2.</span> <span class="toc-text">Finding The Cause</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.3.</span> <span class="toc-text">Examples and Remedies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.4.</span> <span class="toc-text">Class Objects / Creating an Instance</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.5.</span> <span class="toc-text">Arrays</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.6.</span> <span class="toc-text">Lists and Collections</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.7.</span> <span class="toc-text">Data Provider Objects</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.8.</span> <span class="toc-text">Object Paths / Nested</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.9.</span> <span class="toc-text">UI Controls</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.10.</span> <span class="toc-text">Visual Basic Forms</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.11.</span> <span class="toc-text">Function Returning Nothing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.12.</span> <span class="toc-text">Poorly Implemented Try/Catch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.13.</span> <span class="toc-text">DBNull is not the same as Nothing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.14.</span> <span class="toc-text">Controls</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.14.1.</span> <span class="toc-text">The DataGridView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.14.2.</span> <span class="toc-text">Example 2 a Beware of the NewRow</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.15.</span> <span class="toc-text">My.Settings (StringCollection)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">6.</span> <span class="toc-text">Key Points</span></a></li></ol>
		
		</div>
		

        <ins class="adsbygoogle"
     style="display:block; text-align:center; overflow:hidden;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-6300557868920774"
     data-ad-slot="6882414849"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


		<p>我有一些代码，当它执行时，它抛出一个<code>NullReferenceException</code>，说：</p>
<blockquote>
<p>Object reference not set to an instance of an object.</p>
</blockquote>
<p>这是什么意思，我该怎么办才能解决这个错误？</p>
<a id="more"></a>
<h1><span id="what-is-the-cause">What is the cause?</span></h1><h2><span id="bottom-line">Bottom Line</span></h2><p>您试图在VB.NET中使用<code>null</code>（或<code>Nothing</code>）。这意味着你可以将它设置为<code>null</code>，否则你根本就没有设置它。</p>
<p>像其他任何东西一样，<code>null</code>会被传递。如果它是<em>方法“A”中的<code>null</code> </em>，则可能是该方法“B”将<code>null</code> <em>传递给</em> 方法“A”。</p>
<p>本文的其余部分详细介绍了许多程序员经常犯的错误，这些错误可能导致<code>NullReferenceException</code>。</p>
<h2><span id="more-specifically">More Specifically</span></h2><p>运行时抛出一个<code>NullReferenceException</code> <strong>总是</strong> 意味着同样的事情：你正在尝试使用一个引用，并且引用没有被初始化（或者它是<br><em>__ 已经初始化，但是 </em>不再被初始化）。</p>
<p>这意味着引用是<code>null</code>，您不能通过<code>null</code>引用访问成员（例如方法）。最简单的情况：</p>
<pre><code>string foo = null;
foo.ToUpper();
</code></pre><p>这将在第二行抛出一个<code>NullReferenceException</code>因为你不能在<code>string</code>引用指针上调用实例方法<code>ToUpper（）</code>到<code>null</code>。</p>
<h1><span id="debugging">Debugging</span></h1><p>你如何找到<code>NullReferenceException</code>的来源？除了查看异常本身，这些异常将被抛出到它发生的位置，Visual<br>Studio中调试的一般规则将适用：放置战略性断点和[。</p>
<p>如果您想查找引用的位置或未设置的位置，请右键单击其名称并选择“查找所有引用”。然后，您可以在每个找到的位置放置一个断点，并使用附加的调试器运行程序。每当调试器在这样的断点处断开时，您需要确定是否期望引用是非空的，检查变量并验证它是否指向实例。</p>
<p>通过这样的程序流程，你可以找到实例不应该为null的位置，以及为什么它没有正确设置。</p>
<h1><span id="examples">Examples</span></h1><p>可能引发异常的一些常见情况：</p>
<h3><span id="generic">Generic</span></h3><pre><code>ref1.ref2.ref3.member
</code></pre><p>如果ref1或ref2或ref3为null，那么您将得到一个<code>NullReferenceException</code>。如果你想解决这个问题，那么通过将表达式重写为更简单的等价形式来找出哪一个是空的。</p>
<pre><code>var r1 = ref1;
var r2 = r1.ref2;
var r3 = r2.ref3;
r3.member
</code></pre><p>具体来说，在<code>HttpContext.Current.User.Identity.Name</code>中，<code>HttpContext.Current</code>可以为null，或者<code>User</code>属性可以为空，或<code>Identity</code>属性可以为null。</p>
<h3><span id="class-instances">Class instances</span></h3><p>创建引用（类）类型的变量时，默认情况下将其设置为<code>null</code>。</p>
<pre><code>public class Book {
    public string Title { get; set; }
}
public class Example {
    public void Foo() {
        Book b1;
        string title = b1.Title; // You never initialized the b1 variable.
                                    // there is no book to get the title from.
    }
}
</code></pre><p>类类型变量必须被初始化或设置为已经存在的类实例。初始化是通过使用<code>new</code>关键字完成的。</p>
<pre><code>Book b1 = new Book();
</code></pre><h3><span id="indirect">Indirect</span></h3><pre><code>public class Person {
    public int Age { get; set; }
}
public class Book {
    public Person Author { get; set; }
}
public class Example {
    public void Foo() {
        Book b1 = new Book();
        int authorAge = b1.Author.Age; // You never initialized the Author property.
                                       // there is no Person to get an Age from.
    }
}
</code></pre><p>如果你想避免child（Person）null引用，你可以在父对象的构造函数中初始化它。</p>
<p>嵌套对象初始值设定项也适用：</p>
<pre><code>Book b1 = new Book { Author = { Age = 45 } };
</code></pre><p>当使用<code>new</code>关键字时，它只会创建一个新的<code>Book</code>实例，而不是<code>Person</code>的新实例，所以<code>Author</code>该属性仍然是<code>null</code>。</p>
<h3><span id="array">Array</span></h3><pre><code>int[] numbers = null;
int n = numbers[0]; // numbers is null. There is no array to index.
</code></pre><h3><span id="array-elements">Array Elements</span></h3><pre><code>Person[] people = new Person[5];
people[0].Age = 20 // people[0] is null. The array was allocated but not
                   // initialized. There is no Person to set the Age for.
</code></pre><h3><span id="jagged-arrays">Jagged Arrays</span></h3><pre><code>long[][] array = new long[1][];
array[0][0] = 3; // is null because only the first dimension is yet initialized.
                 // Use array[0] = new long[2]; first.
</code></pre><h3><span id="collectionlistdictionary">Collection/List/Dictionary</span></h3><pre><code>Dictionary&lt;string, int&gt; agesForNames = null;
int age = agesForNames[&quot;Bob&quot;]; // agesForNames is null.
                               // There is no Dictionary to perform the lookup.
</code></pre><h3><span id="range-variable-indirectdeferred">Range Variable (Indirect/Deferred)</span></h3><pre><code>public class Person {
    public string Name { get; set; }
}
var people = new List&lt;Person&gt;();
people.Add(null);
var names = from p in people select p.Name;
string firstName = names.First(); // Exception is thrown here, but actually occurs
                                  // on the line above.  &quot;p&quot; is null because the
                                  // first element we added to the list is null.
</code></pre><h3><span id="events">Events</span></h3><pre><code>public class Demo
{
    public event EventHandler StateChanged;

    protected virtual void OnStateChanged(EventArgs e)
    {        
        StateChanged(this, e); // Exception is thrown here 
                               // if no event handlers have been attached
                               // to StateChanged event
    }
}
</code></pre><h3><span id="bad-naming-conventions">Bad Naming Conventions:</span></h3><p>如果您将字段命名为与本地人不同，您可能已经意识到您从未初始化该字段。</p>
<pre><code>public class Form1 {
    private Customer customer;

    private void Form1_Load(object sender, EventArgs e) {
        Customer customer = new Customer();
        customer.Name = &quot;John&quot;;
    }

    private void Button_Click(object sender, EventArgs e) {
        MessageBox.Show(customer.Name);
    }
}
</code></pre><p>这可以通过遵循约定来用下划线前缀字段来解决：</p>
<pre><code>private Customer _customer;
</code></pre><h3><span id="aspnet-page-life-cycle">ASP.NET Page Life cycle:</span></h3><pre><code>public partial class Issues_Edit : System.Web.UI.Page
{
    protected TestIssue myIssue;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            // Only called on first load, not when button clicked
            myIssue = new TestIssue(); 
        }
    }

    protected void SaveButton_Click(object sender, EventArgs e)
    {
        myIssue.Entry = &quot;NullReferenceException here!&quot;;
    }
}
</code></pre><h3><span id="aspnet-session-values">ASP.NET Session Values</span></h3><pre><code>// if the &quot;FirstName&quot; session value has not yet been set,
// then this line will throw a NullReferenceException
string firstName = Session[&quot;FirstName&quot;].ToString();
</code></pre><h3><span id="aspnet-mvc-empty-view-models">ASP.NET MVC empty view models</span></h3><p>如果在ASP.NET MVC视图中引用<code>@Model</code>的属性时发生异常，您需要明白<code>Model</code>在action方法中被设置，当你<code>返回</code>一个视图。当您从控制器返回空模型（或模型属性）时，当视图访问它时会发生异常：</p>
<pre><code>// Controller
public class Restaurant:Controller
{
    public ActionResult Search()
    {
         return View();  // Forgot the provide a Model here.
    }
}

// Razor view 
@foreach (var restaurantSearch in Model.RestaurantSearch)  // Throws.
{
}

&lt;p&gt;@Model.somePropertyName&lt;/p&gt; &lt;!-- Also throws --&gt;
</code></pre><h3><span id="wpf-control-creation-order-and-events">WPF Control Creation Order and Events</span></h3><p>WPF控件是在调用<code>InitializeComponent</code>的过程中以它们出现在可视化树中的顺序创建的。在<code>InitializeComponent</code>期间引用了后期创建的控件的事件处理程序等早期创建的控件中，将引发<code>NullReferenceException</code>。</p>
<p>例如：</p>
<pre><code>&lt;Grid&gt;
    &lt;!-- Combobox declared first --&gt;
    &lt;ComboBox Name=&quot;comboBox1&quot; 
              Margin=&quot;10&quot;
              SelectedIndex=&quot;0&quot; 
              SelectionChanged=&quot;comboBox1_SelectionChanged&quot;&gt;
        &lt;ComboBoxItem Content=&quot;Item 1&quot; /&gt;
        &lt;ComboBoxItem Content=&quot;Item 2&quot; /&gt;
        &lt;ComboBoxItem Content=&quot;Item 3&quot; /&gt;
    &lt;/ComboBox&gt;

    &lt;!-- Label declared later --&gt;
    &lt;Label Name=&quot;label1&quot; 
           Content=&quot;Label&quot;
           Margin=&quot;10&quot; /&gt;
&lt;/Grid&gt;
</code></pre><p>这里<code>comboBox1</code>是在<code>label1</code>之前创建的。如果<code>comboBox1_SelectionChanged</code>试图引用label1，它将不会被创建。</p>
<pre><code>private void comboBox1_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    label1.Content = comboBox1.SelectedIndex.ToString(); // NullReference here!!
}
</code></pre><p>改变XAML中声明的顺序（即在<code>comboBox1</code>之前列出<code>label1</code>，忽略设计原理的问题，至少可以解决`NullReferenceException &lt; / code&gt;在这里。</p>
<h3><span id="cast-with-as">Cast with <code>as</code></span></h3><pre><code>var myThing = someObject as Thing;
</code></pre><p>当转换失败时（以及someObject本身为null），这不会抛出InvalidCastException，但会返回一个<code>null</code>。所以要注意这一点。</p>
<h3><span id="linq-firstordefault-and-singleordefault">LINQ FirstOrDefault() and SingleOrDefault()</span></h3><p>当没有任何东西的时候，普通版本的（）<code>和</code> Single（）`会抛出异常。在这种情况下，“OrDefault”版本返回null。所以要注意这一点。</p>
<h3><span id="foreach">foreach</span></h3><p>当您尝试迭代空集合时，foreach <code>抛出。通常由返回集合的方法导致意外的</code> null `结果。</p>
<pre><code>List&lt;int&gt; list = null;    
foreach(var v in list) { } // exception
</code></pre><p>更实际的例子 - 从XML文档中选择节点。如果没有找到节点，将抛出，但初始调试显示所有属性都有效：</p>
<pre><code>foreach (var node in myData.MyXml.DocumentNode.SelectNodes(&quot;//Data&quot;))
</code></pre><hr>
<h1><span id="ways-to-avoid">Ways to Avoid</span></h1><h3><span id="explicitly-check-for-null-and-ignore-null-values">Explicitly check for <code>null</code> and ignore null values.</span></h3><p>如果您希望引用有时为空，则可以在访问实例成员之前检查它是否为<code>null</code>：</p>
<pre><code>void PrintName(Person p) {
    if (p != null) {
        Console.WriteLine(p.Name);
    }
}
</code></pre><h3><span id="explicitly-check-for-null-and-provide-a-default-value">Explicitly check for <code>null</code> and provide a default value.</span></h3><p>方法调用您期望返回一个实例可以返回<code>null</code>，例如当找不到的对象时。在这种情况下，您可以选择返回默认值：</p>
<pre><code>string GetCategory(Book b) {
    if (b == null)
        return &quot;Unknown&quot;;
    return b.Category;
}
</code></pre><h3><span id="explicitly-check-for-null-from-method-calls-and-throw-a-custom">Explicitly check for <code>null</code> from method calls and throw a custom</span></h3><p>exception.</p>
<p>您也可以抛出一个自定义的异常，只是为了在调用的代码中捕获它：</p>
<pre><code>string GetCategory(string bookTitle) {
    var book = library.FindBook(bookTitle);  // This may return null
    if (book == null)
        throw new BookNotFoundException(bookTitle);  // Your custom exception
    return book.Category;
}
</code></pre><h3><span id="use-debugassert-if-a-value-should-never-be-null-to-catch-the-problem">Use <code>Debug.Assert</code> if a value should never be <code>null</code>, to catch the problem</span></h3><p>earlier than the exception occurs.</p>
<p>在开发过程中，如果知道某个方法可能可以，但从来不应该返回<code>null</code>，那么可以使用<code>Debug.Assert（）</code>确实发生：</p>
<pre><code>string GetTitle(int knownBookID) {
    // You know this should never return null.
    var book = library.GetBook(knownBookID);  

    // Exception will occur on the next line instead of at the end of this method.
    Debug.Assert(book != null, &quot;Library didn&apos;t return a book for known book ID.&quot;);

    // Some other code

    return book.Title; // Will never throw NullReferenceException in Debug mode.
}
</code></pre><p>虽然这个检查<a href="https://stackoverflow.com/questions/3021538/debug-assert-
appears-in-release-mode" target="_blank" rel="noopener">不会在你的发布版本</a>结束，造成它在发布模式下在运行时<code>book == null</code>时再次抛出<code>NullReferenceException</code>。</p>
<h3><span id="use-getvalueordefault-for-nullable-value-types-to-provide-a-default">Use <code>GetValueOrDefault()</code> for nullable value types to provide a default</span></h3><p>value when they are <code>null</code>.</p>
<pre><code>DateTime? appointment = null;
Console.WriteLine(appointment.GetValueOrDefault(DateTime.Now));
// Will display the default value provided (DateTime.Now), because appointment is null.

appointment = new DateTime(2022, 10, 20);
Console.WriteLine(appointment.GetValueOrDefault(DateTime.Now));
// Will display the appointment date, not the default
</code></pre><h3><span id="use-the-null-coalescing-operator-c-or-if-vb">Use the null coalescing operator: <code>??</code> [C#] or <code>If()</code> [VB].</span></h3><p>遇到<code>null</code>时提供默认值的速记：</p>
<pre><code>IService CreateService(ILogger log, Int32? frobPowerLevel)
{
    var serviceImpl = new MyService(log ?? NullLog.Instance);

    // Note that the above &quot;GetValueOrDefault()&quot; can also be rewritten to use
    // the coalesce operator:
    serviceImpl.FrobPowerLevel = frobPowerLevel ?? 5;
}
</code></pre><h3><span id="use-the-null-condition-operator-available-in-c-6-and-vbnet-14">Use the null condition operator: <code>?.</code> (available in C# 6 and VB.NET 14):</span></h3><p>这也有时被称为安全导航或埃尔维斯（在它的形状之后）操作符。如果运算符左侧的表达式为空，则右侧将不计算，而返回null。这意味着像这样的情况：</p>
<pre><code>var title = person.Title.ToUpper();
</code></pre><p>如果这个人没有标题，这会抛出一个异常，因为它试图在一个空值属性上调用<code>ToUpper</code>。</p>
<p>在C＃5及以下版本中，可以用下面的方式来保护：</p>
<pre><code>var title = person.Title == null ? null : person.Title.ToUpper();
</code></pre><p>现在标题变量将是空的，而不是引发异常。 C＃6为此引入了更简短的语法：</p>
<pre><code>var title = person.Title?.ToUpper();
</code></pre><p>这会导致title变量为<code>null</code>，如果<code>person.Title</code>是<code>，则不会调用</code> ToUpper `空</p>
<p>当然，您仍然必须检查<code>title</code>为null，或者将null condition运算符与null合并运算符（<code>??</code> ）提供默认值：</p>
<pre><code>// regular null check
int titleLength = 0;
if (title != null)
    titleLength = title.Length; // If title is null, this would throw NullReferenceException

// combining the `?` and the `??` operator
int titleLength = title?.Length ?? 0;
</code></pre><h1><span id="nullreference-exception-a-visual-basic">NullReference Exception a Visual Basic</span></h1><p><strong>Visual Basic</strong> 的<code>NullReference Exception</code>与 <strong>C＃</strong> 中的<code>NullReference
Exception</code>没有区别。毕竟，它们都报告了它们都使用的.NET Framework中定义的相同异常。 Visual<br>Basic特有的原因很少见（可能只有一个）。</p>
<p>这个答案将使用Visual Basic术语，语法和上下文。使用的例子来自大量的Stack Overflow问题。这是通过使用在帖子中经常看到的 <em>种类</em><br>的情况来最大化相关性。还为可能需要它的人提供了更多的解释。类似于你的例子很可能在这里列出。</p>
<p>**注意：</p>
<ul>
<li>这是基于概念的：没有代码可以粘贴到您的项目中。它旨在帮助您了解导致<code>NullReferenceException</code>（NRE）的原因，如何找到它，如何解决它，以及如何避免它。一个NRE可以有多种方式，所以这不太可能是你唯一的遭遇。</li>
<li>这些例子（来自Stack Overflow的帖子）并不总是展示最好的方式来做一些事情。<br>通常，使用最简单的补救措施。</li>
</ul>
<h2><span id="basic-meaning">Basic Meaning</span></h2><p>消息 <em>“对象未设置为对象的实例”</em> 意味着您正在尝试使用尚未初始化的对象。这归结为其中之一：</p>
<ul>
<li><p>你的代码 <em>声明了一个对象变量，但是它没有初始化</em> 它（创建一个实例或者实例化它）<br>&gt;</p>
</li>
<li><p>你的代码假定会初始化一个对象，而不是</p>
</li>
<li>其他代码可能过早地使仍在使用的对象无效</li>
</ul>
<h2><span id="finding-the-cause">Finding The Cause</span></h2><p>由于问题是一个对象引用是<code>Nothing</code>，答案是检查他们找出哪一个。然后确定它为什么没有被初始化。将鼠标放在各种变量上，Visual<br>Studio（VS）将显示它们的值 - 罪魁祸首将是<code>Nothing</code>。</p>
<p><img src="“https://i.stack.imgur.com/5ndSA.jpg”alt" alt=""></p>
<p>你也应该删除相关代码中的任何Try / Catch块，尤其是那些Catch块中没有任何内容的代码块。这会导致您的代码在尝试使用<code>Nothing</code>对象时崩溃。 <strong>这就是你想要的</strong> ，因为它可以识别问题的确切位置，并且可以识别造成该问题的对象。</p>
<p>Catch中的<code>MsgBox</code>显示<code>Error while ...</code>时没有什么帮助。这个方法也会导致Stack<br>Overflow的问题，因为你不能描述实际的异常，涉及的对象，甚至是代码行。</p>
<p>您也可以使用<code>Locals Window</code>（ <strong>Debug - ＆gt; Windows - ＆gt; Locals</strong> ）来检查您的对象。</p>
<p>一旦你知道问题出在什么地方，通常很容易解决问题，而且比发布一个新问题更快。</p>
<p>另见：</p>
<ul>
<li><a href="http://msdn.microsoft.com/zh-CN/library/ktf38f66.aspx" target="_blank" rel="noopener">断点</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/xtd0s8kd\(v=vs.110\" target="_blank" rel="noopener"> MSDN：如何：使用Try /捕捉块以捕捉异常</a>.aspx)</li>
<li><a href="http://msdn.microsoft.com/en-us/library/seyhszts\(v=vs.110\" target="_blank" rel="noopener"> MSDN：异常的最佳实践</a>.aspx)</li>
</ul>
<h2><span id="examples-and-remedies">Examples and Remedies</span></h2><h2><span id="class-objects-creating-an-instance">Class Objects / Creating an Instance</span></h2><pre><code>Dim reg As CashRegister
...
TextBox1.Text = reg.Amount         &apos; NRE
</code></pre><p>问题在于<code>Dim</code>不会创建一个CashRegister <em>对象</em> ;它只声明该类型的名为<code>reg</code>的变量。 <em>声明</em> 一个对象变量并创建一个<br><em>实例</em> 是两回事。</p>
<p>&lt;强&gt;解决方法</p>
<p>当您声明时，<code>New</code>操作符通常可以用来创建实例：</p>
<pre><code>Dim reg As New CashRegister        &apos; [New] creates instance, invokes the constructor

&apos; Longer, more explicit form:
Dim reg As CashRegister = New CashRegister
</code></pre><p>以后只适合于创建实例：</p>
<pre><code>Private reg As CashRegister         &apos; Declare
  ...
reg = New CashRegister()            &apos; Create instance
</code></pre><p>注意： <strong>不要</strong> 在包含构造函数（<code>Sub New</code>）的过程中再次使用<code>Dim</code>：</p>
<pre><code>Private reg As CashRegister
&apos;...

Public Sub New()
   &apos;...
   Dim reg As New CashRegister
End Sub
</code></pre><p>这将创建一个仅存在于该上下文（sub）中的 <em>local</em> 变量<code>reg</code>。您将在其他地方使用的模块级<code>Scope</code>的<code>reg</code>变量仍然是<code>Nothing</code>。</p>
<blockquote>
<p><strong>Missing the<code>New</code> operator is the #1 cause of <code>NullReference Exceptions</code></strong><br>seen in the Stack   Overflow questions reviewed.</p>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>Visual Basic tries to make the process clear repeatedly using <strong><code>New</code></strong> :<br>Using the <strong><code>New</code></strong> Operator creates a <strong>new</strong> object and calls <strong><code>Sub New</code></strong><br>-- the constructor – where your object can perform any other initialization.</p>
</blockquote>
<p>明确地说，<code>Dim</code>（或<code>Private</code>）只能 <em>声明</em> 一个变量及其<code>Type</code>。变量的 _ - 是否存在于整个模块/类中，还是程序本地的</p>
<ul>
<li>由 _<em> 决定。 <code>Private |朋友|公开</code>定义访问级别，而不是 </em>。</li>
</ul>
<p>有关更多信息，请参阅：</p>
<ul>
<li><a href="http://msdn.microsoft.com/zh-CN/library/77s47661.aspx" target="_blank" rel="noopener">新运营商</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/1t0wsc67.aspx" target="_blank" rel="noopener"> Visual Basic中的作用域</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/76453kax.aspx" target="_blank" rel="noopener"> Visual Basic中的访问级别</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/t63sy5hs.aspx" target="_blank" rel="noopener">值类型和参考类型</a></li>
</ul>
<hr>
<h2><span id="arrays">Arrays</span></h2><p>数组也必须被实例化：</p>
<pre><code>Private arr as String()
</code></pre><p>这个数组只是被声明的，没有被创建。有几种方法来初始化一个数组：</p>
<pre><code>Private arr as String() = New String(10){}
&apos; or
Private arr() As String = New String(10){}

&apos; For a local array (in a procedure) and using &apos;Option Infer&apos;:
Dim arr = New String(10) {}
</code></pre><p>注意：从VS 2010开始，当使用文字和<code>Option Infer</code>初始化本地数组时，<code>As＆lt; Type＆gt;</code>和<code>New</code>元素是可选的：</p>
<pre><code>Dim myDbl As Double() = {1.5, 2, 9.9, 18, 3.14}
Dim myDbl = New Double() {1.5, 2, 9.9, 18, 3.14}
Dim myDbl() = {1.5, 2, 9.9, 18, 3.14}
</code></pre><p>数据类型和数组大小是从被分配的数据中推断出来的。类/模块级声明仍然要求<code>As＆lt; Type＆gt;</code>与<code>Option Strict</code>：</p>
<pre><code>Private myDoubles As Double() = {1.5, 2, 9.9, 18, 3.14}
</code></pre><p>**示例：类对象数组</p>
<pre><code>Dim arrFoo(5) As Foo

For i As Integer = 0 To arrFoo.Count - 1
   arrFoo(i).Bar = i * 10       &apos; Exception
Next
</code></pre><p>该数组已经创建，但其中的<code>Foo</code>对象没有。</p>
<p>&lt;强&gt;解决方法</p>
<pre><code>For i As Integer = 0 To arrFoo.Count - 1
    arrFoo(i) = New Foo()         &apos; Create Foo instance
    arrFoo(i).Bar = i * 10
Next
</code></pre><p>使用<code>List（Of T）</code>会使得没有有效对象的元素变得相当困难：</p>
<pre><code>Dim FooList As New List(Of Foo)     &apos; List created, but it is empty
Dim f As Foo                        &apos; Temporary variable for the loop

For i As Integer = 0 To 5
    f = New Foo()                    &apos; Foo instance created
    f.Bar =  i * 10
    FooList.Add(f)                   &apos; Foo object added to list
Next
</code></pre><p>有关更多信息，请参阅：</p>
<ul>
<li><a href="http://msdn.microsoft.com/zh-CN/library/bb384665.aspx" target="_blank" rel="noopener">选项推断声明</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/1t0wsc67.aspx" target="_blank" rel="noopener"> Visual Basic中的作用域</a></li>
<li><a href="http://msdn.microsoft.com/en-us/library/wak0wfyt.aspx" target="_blank" rel="noopener"> Visual Basic中的数组</a></li>
</ul>
<hr>
<h2><span id="lists-and-collections">Lists and Collections</span></h2><p>.NET集合（其中有许多种类 - 列表，词典等）也必须被实例化或创建。</p>
<pre><code>Private myList As List(Of String)
..
myList.Add(&quot;ziggy&quot;)           &apos; NullReference
</code></pre><p>由于相同的原因，您得到相同的异常 - <code>myList</code>仅被声明，但没有创建实例。补救措施是一样的：</p>
<pre><code>myList = New List(Of String)

&apos; Or create an instance when declared:
Private myList As New List(Of String)
</code></pre><p>常见的疏忽是使用集合<code>Type</code>：</p>
<p>的类</p>
<pre><code>Public Class Foo
    Private barList As List(Of Bar)

    Friend Function BarCount As Integer
        Return barList.Count
    End Function

    Friend Sub AddItem(newBar As Bar)
        If barList.Contains(newBar) = False Then
            barList.Add(newBar)
        End If
    End Function
</code></pre><p>任何一个过程都会导致一个NRE，因为<code>barList</code>只是声明的，没有实例化。创建<code>Foo</code>的实例不会创建内部<code>barList</code>的实例。它可能是在构造函数中执行此操作的意图：</p>
<pre><code>Public Sub New         &apos; Constructor
    &apos; Stuff to do when a new Foo is created...
    barList = New List(Of Bar)
End Sub
</code></pre><p>像以前一样，这是不正确的：</p>
<pre><code>Public Sub New()
    &apos; Creates another barList local to this procedure
     Dim barList As New List(Of Bar)
End Sub
</code></pre><p>有关更多信息，请参见<a href="http://msdn.microsoft.com/zh-
CN/library/6sh2ey19\(v=vs.110\" target="_blank" rel="noopener"> <code>List （Of T）</code>类</a>.aspx)。</p>
<hr>
<h2><span id="data-provider-objects">Data Provider Objects</span></h2><p>使用数据库为NullReference提供了很多机会，因为可以有许多对象（<code>Command</code>，<code>Connection</code>，<code>Transaction</code>，<code>Dataset</code>，<code>DataTable</code>，<code>DataRows</code> ….）。 <strong>注意：</strong> 不管您使用哪个数据提供程序 -<br>MySQL，SQL Server，OleDB等 - <em>概念</em> 都是相同的。</p>
<p><strong>示例1</strong></p>
<pre><code>Dim da As OleDbDataAdapter
Dim ds As DataSet
Dim MaxRows As Integer

con.Open()
Dim sql = &quot;SELECT * FROM tblfoobar_List&quot;
da = New OleDbDataAdapter(sql, con)
da.Fill(ds, &quot;foobar&quot;)
con.Close()

MaxRows = ds.Tables(&quot;foobar&quot;).Rows.Count      &apos; Error
</code></pre><p>像以前一样，ds <code>数据集对象被声明，但是一个实例从未被创建过。</code> DataAdapter <code>将填充现有的</code> DataSet<br><code>，而不是创建一个。在这种情况下，由于</code> ds `是一个局部变量，所以IDE警告您_ 可能发生这种情况：</p>
<p><img src="“https://i.stack.imgur.com/E5d94.jpg”alt" alt=""></p>
<p>当声明为模块/类级别的变量时，与<code>con</code>一样，编译器无法知道对象是否由上游过程创建。不要忽视警告。</p>
<p>&lt;强&gt;解决方法</p>
<pre><code>Dim ds As New DataSet
</code></pre><p><strong>示例2</strong></p>
<pre><code>ds = New DataSet
da = New OleDBDataAdapter(sql, con)
da.Fill(ds, &quot;Employees&quot;)

txtID.Text = ds.Tables(&quot;Employee&quot;).Rows(0).Item(1)
txtID.Name = ds.Tables(&quot;Employee&quot;).Rows(0).Item(2)
</code></pre><p>错字是这里的一个问题：<code>Employees</code> vs <code>Employee</code>。没有创建名为“Employee”的<code>DataTable</code>，因此尝试访问它的<code>NullReferenceException</code>结果。另一个潜在的问题是假定当SQL包含WHERE子句时，会有<code>Items</code>，这可能不是这样的。</p>
<p>&lt;强&gt;解决方法</p>
<p>由于使用了一个表，使用<code>Tables（0）</code>将避免拼写错误。检查<code>Rows.Count</code>也可以帮助：</p>
<pre><code>If ds.Tables(0).Rows.Count &gt; 0 Then
    txtID.Text = ds.Tables(0).Rows(0).Item(1)
    txtID.Name = ds.Tables(0).Rows(0).Item(2)
End If
</code></pre><p>Fill <code>是一个函数，它返回了</code> Rows `的数目，也可以被测试：</p>
<pre><code>If da.Fill(ds, &quot;Employees&quot;) &gt; 0 Then...
</code></pre><p><strong>示例3</strong></p>
<pre><code>Dim da As New OleDb.OleDbDataAdapter(&quot;SELECT TICKET.TICKET_NO,
        TICKET.CUSTOMER_ID, ... FROM TICKET_RESERVATION AS TICKET INNER JOIN
        FLIGHT_DETAILS AS FLIGHT ... WHERE [TICKET.TICKET_NO]= ...&quot;, con)
Dim ds As New DataSet
da.Fill(ds)

If ds.Tables(&quot;TICKET_RESERVATION&quot;).Rows.Count &gt; 0 Then
</code></pre><p><code>DataAdapter</code>将提供<code>TableNames</code>，如前例所示，但它不解析SQL或数据库表中的名字。因此，<code>ds.Tables（“TICKET_RESERVATION”）</code>引用了一个不存在的表。</p>
<p><strong>Remedy</strong> 是相同的，通过索引引用表：</p>
<pre><code>If ds.Tables(0).Rows.Count &gt; 0 Then
</code></pre><p>另见[ DataTable Class &lt; / A&gt;</p>
<hr>
<h2><span id="object-paths-nested">Object Paths / Nested</span></h2><pre><code>If myFoo.Bar.Items IsNot Nothing Then
   ...
</code></pre><p><code>代码只是测试</code> Items <code>，而</code> myFoo <code>和</code> Bar `也可能是Nothing。 <strong>补救措施</strong> 是一次测试一个对象的整个链或路径：</p>
<pre><code>If (myFoo IsNot Nothing) AndAlso
    (myFoo.Bar IsNot Nothing) AndAlso
    (myFoo.Bar.Items IsNot Nothing) Then
    ....
</code></pre><p><code>AndAlso</code>很重要。一旦遇到第一个<code>False</code>条件，后续测试将不会执行。这允许代码一次安全地“钻取”到一个“级别”的对象中，只有在确定（和if）<code>myFoo</code>之后，才评估<code>myFoo.Bar</code>是有效的。编码复杂对象时，对象链或路径可能会变得很长：</p>
<pre><code>myBase.myNodes(3).Layer.SubLayer.Foo.Files.Add(&quot;somefilename&quot;)
</code></pre><p>无法引用<code>null</code>对象的任何“下游”。这也适用于控制：</p>
<pre><code>myWebBrowser.Document.GetElementById(&quot;formfld1&quot;).InnerText = &quot;some value&quot;
</code></pre><p>这里，<code>myWebBrowser</code>或者<code>Document</code>可能是Nothing，或者<code>formfld1</code>元素可能不存在。</p>
<hr>
<h2><span id="ui-controls">UI Controls</span></h2><pre><code>Dim cmd5 As New SqlCommand(&quot;select Cartons, Pieces, Foobar &quot; _
     &amp; &quot;FROM Invoice where invoice_no = &apos;&quot; &amp; _
     Me.ComboBox5.SelectedItem.ToString.Trim &amp; &quot;&apos; And category = &apos;&quot; &amp; _
     Me.ListBox1.SelectedItem.ToString.Trim &amp; &quot;&apos; And item_name = &apos;&quot; &amp; _
     Me.ComboBox2.SelectedValue.ToString.Trim &amp; &quot;&apos; And expiry_date = &apos;&quot; &amp; _
     Me.expiry.Text &amp; &quot;&apos;&quot;, con)
</code></pre><p>除此之外，这段代码并不预期用户可能没有在一个或多个UI控件中选择一些东西。 <code>ListBox1.SelectedItem</code>很可能是<code>Nothing</code>，所以<code>ListBox1.SelectedItem.ToString</code>将导致NRE。</p>
<p>&lt;强&gt;解决方法</p>
<p>在使用它之前验证数据（也可以使用<code>Option Strict</code>和SQL参数）：</p>
<pre><code>Dim expiry As DateTime         &apos; for text date validation
If (ComboBox5.SelectedItems.Count &gt; 0) AndAlso
    (ListBox1.SelectedItems.Count &gt; 0) AndAlso
    (ComboBox2.SelectedItems.Count &gt; 0) AndAlso
    (DateTime.TryParse(expiry.Text, expiry) Then

    &apos;... do stuff
Else
    MessageBox.Show(...error message...)
End If
</code></pre><p>或者，您可以使用<code>（ComboBox5.SelectedItem IsNot Nothing）AndAlso ...</code></p>
<hr>
<h2><span id="visual-basic-forms">Visual Basic Forms</span></h2><pre><code>Public Class Form1

    Private NameBoxes = New TextBox(5) {Controls(&quot;TextBox1&quot;), _
                   Controls(&quot;TextBox2&quot;), Controls(&quot;TextBox3&quot;), _
                   Controls(&quot;TextBox4&quot;), Controls(&quot;TextBox5&quot;), _
                   Controls(&quot;TextBox6&quot;)}

    &apos; same thing in a different format:
    Private boxList As New List(Of TextBox) From {TextBox1, TextBox2, TextBox3 ...}

    &apos; Immediate NRE:
    Private somevar As String = Me.Controls(&quot;TextBox1&quot;).Text
</code></pre><p>这是获得NRE的一个相当常见的方法。在C＃中，根据编码的方式，IDE将报告<code>Controls</code>在当前上下文中不存在，或者“不能引用非静态成员”。所以，在某种程度上，这是一个VB的情况。它也很复杂，因为它可能导致级联失败。</p>
<p><em> </em>这个初始化代码将在构造函数创建<code>Form</code>或`控制。结果是：</p>
<ul>
<li>列表和集合将简单地为空</li>
<li>数组将包含Nothing的五个元素<br><code></code> somevar <code>赋值将会立即生成NRE，因为Nothing没有</code> .Text `属性</li>
</ul>
<p>稍后引用数组元素将导致NRE。如果您在<code>Form_Load</code>中执行此操作，由于有一个奇怪的错误，IDE<br><em>可能不会在发生异常时报告异常。当代码尝试使用该数组时，将在 </em>稍后弹出_<br>异常。这个“无声的例外”是<a href="https://stackoverflow.com/a/4934010/1070452" target="_blank" rel="noopener">在这篇文章中详述</a>。出于我们的目的，关键是当创建表单（<code>Sub New</code>或<code>Form Load</code>事件）发生灾​​难性事件时，异常可能不会被报告，代码会退出过程，只是显示表单。</p>
<p>因为在NRE之后，您的<code>Sub New</code>或<code>Form Load</code>事件中没有其他代码会运行，所以还有很多其他的东西可以留下初始化。</p>
<pre><code>Sub Form_Load(..._
   &apos;...
   Dim name As String = NameBoxes(2).Text        &apos; NRE
   &apos; ...
   &apos; More code (which will likely not be executed)
   &apos; ...
End Sub
</code></pre><p><strong>注意</strong>这适用于任何和所有控制和组件引用，因为它们是非法的：</p>
<pre><code>Public Class Form1

    Private myFiles() As String = Me.OpenFileDialog1.FileName &amp; ...
    Private dbcon As String = OpenFileDialog1.FileName &amp; &quot;;Jet Oledb...&quot;
    Private studentName As String = TextBox13.Text
</code></pre><p><strong>部分补救</strong></p>
<p>很奇怪VB没有提供警告，但补救方法是在表单级别声明 <strong>容器，但是在表单加载事件处理程序中 </strong>初始化<strong> 存在控件 </strong>do** 。只要您的代码位于<code>InitializeComponent</code>之后，就可以在<code>Sub New</code>中完成：</p>
<pre><code>&apos; Module level declaration
Private NameBoxes as TextBox()
Private studentName As String

&apos; Form Load, Form Shown or Sub New:
&apos;
&apos; Using the OP&apos;s approach (illegal using OPTION STRICT)
NameBoxes = New TextBox() {Me.Controls(&quot;TextBox1&quot;), Me.Controls(&quot;TestBox2&quot;), ...)
studentName = TextBox32.Text           &apos; For simple control references
</code></pre><p>数组代码可能还没有走出困境。在<code>Me.Controls</code>中找不到在容器控件中的任何控件（如<code>GroupBox</code>或<code>Panel</code>）。他们将在该Panel或GroupBox的Controls集合中。当控件名称拼写错误（<code>“TeStBox2”</code>）时，也不会返回控件。在这种情况下，<code>Nothing</code>将再次存储在这些数组元素中，并且当您试图引用它时，会产生NRE。</p>
<p>现在应该很容易找到你知道你在找什么： <img src="“https://i.stack.imgur.com/5ndSA.jpg”alt" alt=""></p>
<p>“Button2”驻留在<code>Panel</code><br>上</p>
<p>&lt;强&gt;解决方法</p>
<p>与使用表单的<code>Controls</code>集合进行名称间接引用不同，请使用控件引用：</p>
<pre><code>&apos; Declaration
Private NameBoxes As TextBox()

&apos; Initialization -  simple and easy to read, hard to botch:
NameBoxes = New TextBox() {TextBox1, TextBox2, ...)

&apos; Initialize a List
NamesList = New List(Of TextBox)({TextBox1, TextBox2, TextBox3...})
&apos; or
NamesList = New List(Of TextBox)
NamesList.AddRange({TextBox1, TextBox2, TextBox3...})
</code></pre><hr>
<h2><span id="function-returning-nothing">Function Returning Nothing</span></h2><pre><code>Private bars As New List(Of Bars)        &apos; Declared and created

Public Function BarList() As List(Of Bars)
    bars.Clear
    If someCondition Then
        For n As Integer = 0 to someValue
            bars.Add(GetBar(n))
        Next n
    Else
        Exit Function
    End If

    Return bars
End Function
</code></pre><p>这种情况下，IDE会警告你：“不是所有的路径都返回一个值，而是一个<code>NullReferenceException</code>可能导致_’。您可以通过用<code>Return Nothing</code>替换<code>Exit Function</code>来取消警告，但这并不能解决问题。当<code>someCondition = False</code>时，任何试图使用返回值都会导致NRE：</p>
<pre><code>bList = myFoo.BarList()
For Each b As Bar in bList      &apos; EXCEPTION
      ...
</code></pre><p>&lt;强&gt;解决方法</p>
<p>用<code>Return bList</code>替换函数中的<code>Exit Function</code>。返回 <em>空</em> <code>List</code>与返回<code>Nothing</code>不一样。如果返回的对象有可能是<code>Nothing</code>，那么在使用之前进行测试：</p>
<pre><code>bList = myFoo.BarList()
If bList IsNot Nothing Then...
</code></pre><hr>
<h2><span id="poorly-implemented-trycatch">Poorly Implemented Try/Catch</span></h2><p>一个执行不当的Try / Catch可以隐藏问题所在并导致新问题：</p>
<pre><code>Dim dr As SqlDataReader
Try
    Dim lnk As LinkButton = TryCast(sender, LinkButton)
    Dim gr As GridViewRow = DirectCast(lnk.NamingContainer, GridViewRow)
    Dim eid As String = GridView1.DataKeys(gr.RowIndex).Value.ToString()
    ViewState(&quot;username&quot;) = eid
    sqlQry = &quot;select FirstName, Surname, DepartmentName, ExtensionName, jobTitle,
             Pager, mailaddress, from employees1 where username=&apos;&quot; &amp; eid &amp; &quot;&apos;&quot;
    If connection.State &lt;&gt; ConnectionState.Open Then
        connection.Open()
    End If
    command = New SqlCommand(sqlQry, connection)

    &apos;More code fooing and barring

    dr = command.ExecuteReader()
    If dr.Read() Then
        lblFirstName.Text = Convert.ToString(dr(&quot;FirstName&quot;))
        ...
    End If
    mpe.Show()
Catch

Finally
    command.Dispose()
    dr.Close()             &apos; &lt;-- NRE
    connection.Close()
End Try
</code></pre><p>这是一个没有按预期创建对象的情况，而且还演示了一个空的<code>Catch</code>的计数器有效性。</p>
<p>在SQL中有一个额外的逗号（在’mailaddress’之后），导致在<code>.ExecuteReader</code>出现一个异常。在<code>Catch</code>之后什么都不做，最后<code>试图执行清理，但是因为你不能关闭</code>空的<code>DataReader</code>对象，全新的<code>NullReferenceException</code>结果。</p>
<p>一个空的<code>Catch</code>块是恶魔的游乐场。这个OP很困惑他为什么要在<code>finally</code>块中得到一个NRE。在其他情况下，一个空的<code>Catch</code>可能会导致更远的下游，使你花时间在错误的地方看问题的错误。 （上述“无声的例外”提供了相同的娱乐价值。）</p>
<p>&lt;强&gt;解决方法</p>
<p>不要使用空的Try / Catch块 - 让代码崩溃，这样您可以a）找出原因b）确定位置c）应用适当的补救措施。 Try /<br>Catch块不是为了隐藏唯一有资格修复它们的人的异常 - 开发人员。</p>
<hr>
<h2><span id="dbnull-is-not-the-same-as-nothing">DBNull is not the same as Nothing</span></h2><pre><code>For Each row As DataGridViewRow In dgvPlanning.Rows
    If Not IsDBNull(row.Cells(0).Value) Then
        ...
</code></pre><p><code></code> IsDBNull <code>函数用于测试一个 _值_ 是否等于</code> System.DBNull `：<a href="“http：//">来自MSDN：</a></p>
<blockquote>
<p>The System.DBNull value indicates that the Object represents missing or non-<br>existent data. DBNull is not the same as Nothing, which indicates that a<br>variable has not yet been initialized.</p>
</blockquote>
<p>&lt;强&gt;解决方法</p>
<pre><code>If row.Cells(0) IsNot Nothing Then ...
</code></pre><p>像以前一样，您可以测试Nothing，然后获取特定值：</p>
<pre><code>If (row.Cells(0) IsNot Nothing) AndAlso (IsDBNull(row.Cells(0).Value) = False) Then
</code></pre><p><strong>示例2</strong></p>
<pre><code>Dim getFoo = (From f In dbContext.FooBars
               Where f.something = something
               Select f).FirstOrDefault

If Not IsDBNull(getFoo) Then
    If IsDBNull(getFoo.user_id) Then
        txtFirst.Text = getFoo.first_name
    Else
       ...
</code></pre><p><code>FirstOrDefault</code>返回第一个项目或默认值，它是<code>Nothing</code>的引用类型，从来没有<code>DBNull</code>：</p>
<pre><code>If getFoo IsNot Nothing Then...
</code></pre><hr>
<h2><span id="controls">Controls</span></h2><pre><code>Dim chk As CheckBox

chk = CType(Me.Controls(chkName), CheckBox)
If chk.Checked Then
    Return chk
End If
</code></pre><p>如果找不到<code>chkName</code>的<code>CheckBox</code>（或存在于<code>GroupBox</code>中），那么<code>chk</code>将是没有，并试图引用任何财产将导致例外。</p>
<p>&lt;强&gt;解决方法</p>
<pre><code>If (chk IsNot Nothing) AndAlso (chk.Checked) Then ...
</code></pre><h3><span id="the-datagridview">The DataGridView</span></h3><p>DGV有一些周期性的怪癖：</p>
<pre><code>dgvBooks.DataSource = loan.Books
dgvBooks.Columns(&quot;ISBN&quot;).Visible = True       &apos; NullReferenceException
dgvBooks.Columns(&quot;Title&quot;).DefaultCellStyle.Format = &quot;C&quot;
dgvBooks.Columns(&quot;Author&quot;).DefaultCellStyle.Format = &quot;C&quot;
dgvBooks.Columns(&quot;Price&quot;).DefaultCellStyle.Format = &quot;C&quot;
</code></pre><p>如果<code>dgvBooks</code>具有<code>AutoGenerateColumns = True</code>，它将创建列，但不会命名它们，所以上面的代码在引用它们时会失败。<br>/ p&gt;</p>
<p>&lt;强&gt;解决方法</p>
<p>手动命名列，或按索引引用：</p>
<pre><code>dgvBooks.Columns(0).Visible = True
</code></pre><h3><span id="example-2-a-beware-of-the-newrow">Example 2 a Beware of the NewRow</span></h3><pre><code>xlWorkSheet = xlWorkBook.Sheets(&quot;sheet1&quot;)

For i = 0 To myDGV.RowCount - 1
    For j = 0 To myDGV.ColumnCount - 1
        For k As Integer = 1 To myDGV.Columns.Count
            xlWorkSheet.Cells(1, k) = myDGV.Columns(k - 1).HeaderText
            xlWorkSheet.Cells(i + 2, j + 1) = myDGV(j, i).Value.ToString()
        Next
    Next
Next
</code></pre><p>当您的<code>DataGridView</code>的<code>AllowUserToAddRows</code>为<code>True</code>（默认）时，<code>Cells /</code>在底部的行都将包含<code>Nothing</code>。大多数尝试使用内容（例如，<code>ToString</code>）将导致NRE。</p>
<p>&lt;强&gt;解决方法</p>
<p>使用<code>For / Each</code>循环并测试<code>IsNewRow</code>属性来确定它是否是最后一行。无论<code>AllowUserToAddRows</code>是否为true，这都可以工作：</p>
<pre><code>For Each r As DataGridViewRow in myDGV.Rows
    If r.IsNewRow = False Then
         &apos; ok to use this row
</code></pre><p><code>如果你使用</code> For n <code>循环，当</code> IsNewRow <code>为true时修改行计数或使用</code> Exit For `。</p>
<hr>
<h2><span id="mysettings-stringcollection">My.Settings (StringCollection)</span></h2><p>在某些情况下，尝试使用来自<code>My.Settings</code>的<code>StringCollection</code>中的项目时，可能会在您首次使用它时产生NullReference。解决方案是一样的，但不是那么明显。考虑：</p>
<pre><code>My.Settings.FooBars.Add(&quot;ziggy&quot;)         &apos; foobars is a string collection
</code></pre><p>由于VB为你管理设置，期望它初始化集合是合理的。它将会，但是只有在你之前添加了一个初始条目到集合中（在设置编辑器中）。由于在添加项目时（显然）初始化了集合，因此当设置编辑器中没有项目添加时，它仍然是<code>Nothing</code>。</p>
<p>&lt;强&gt;解决方法</p>
<p>在表单的<code>Load</code>事件处理程序中初始化设置集合，如果/需要时：</p>
<pre><code>If My.Settings.FooBars Is Nothing Then
    My.Settings.FooBars = New System.Collections.Specialized.StringCollection
End If
</code></pre><p>通常，<code>Settings</code>集合只需在应用程序第一次运行时被初始化。另一种补救方法是在 <strong>项目 - ＆gt;项目中添加初始值设置| FooBars</strong><br>，保存项目，然后删除伪造的值。</p>
<hr>
<h1><span id="key-points">Key Points</span></h1><p>您可能已经忘记了<code>New</code>运算符。</p>
<p>或</p>
<p>你所假设的东西完美无缺地将初始化的对象返回给你的代码，没有。</p>
<p>不要忽略编译器警告（永远），并使用<code>Option Strict On</code>（总是）。</p>
<hr>
<p><a href="http://msdn.microsoft.com/en-
us/library/system.nullreferenceexception\(v=vs.110\" target="_blank" rel="noopener"> MSDN NullReference异常</a>.aspx)</p>


        <p style="margin-top:2em; text-align:left; font-weight:bold; font-style: italic;">未经作者同意，本文严禁转载，违者必究！</p>
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


</div>



	<div class="article-share" id="share">
	
	  <div data-url="https://www.tracholar.top/2018/01/19/what-is-a-nullreferenceexception-and-how-do-i-fix-it/" data-title="什么是NullReferenceException，如何解决？ | 智子" data-tsina="" class="share clearfix">
	  </div>
	
	</div>


</footer>


	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2018/01/20/responsive-image-align-center-bootstrap-3/" title="响应式图像对齐中心引导3">
  <strong>上一篇：</strong><br/>
  <span>
  响应式图像对齐中心引导3</span>
</a>
</div>


<div class="next">
<a href="/2018/01/19/can-you-nest-html-forms/"  title="你可以嵌套的HTML表单？">
 <strong>下一篇：</strong><br/> 
 <span>你可以嵌套的HTML表单？
</span>
</a>
</div>

</nav>

	



</div>

      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">What is the cause?</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">Bottom Line</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">More Specifically</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">Debugging</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">Examples</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.1.</span> <span class="toc-text">Generic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.2.</span> <span class="toc-text">Class instances</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.3.</span> <span class="toc-text">Indirect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.4.</span> <span class="toc-text">Array</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.5.</span> <span class="toc-text">Array Elements</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.6.</span> <span class="toc-text">Jagged Arrays</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.7.</span> <span class="toc-text">Collection/List/Dictionary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.8.</span> <span class="toc-text">Range Variable (Indirect/Deferred)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.9.</span> <span class="toc-text">Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.10.</span> <span class="toc-text">Bad Naming Conventions:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.11.</span> <span class="toc-text">ASP.NET Page Life cycle:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.12.</span> <span class="toc-text">ASP.NET Session Values</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.13.</span> <span class="toc-text">ASP.NET MVC empty view models</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.14.</span> <span class="toc-text">WPF Control Creation Order and Events</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.15.</span> <span class="toc-text">Cast with as</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.16.</span> <span class="toc-text">LINQ FirstOrDefault() and SingleOrDefault()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">3.0.17.</span> <span class="toc-text">foreach</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">4.</span> <span class="toc-text">Ways to Avoid</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.1.</span> <span class="toc-text">Explicitly check for null and ignore null values.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.2.</span> <span class="toc-text">Explicitly check for null and provide a default value.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.3.</span> <span class="toc-text">Explicitly check for null from method calls and throw a custom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.4.</span> <span class="toc-text">Use Debug.Assert if a value should never be null, to catch the problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.5.</span> <span class="toc-text">Use GetValueOrDefault() for nullable value types to provide a default</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.6.</span> <span class="toc-text">Use the null coalescing operator: ?? [C#] or If() [VB].</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">4.0.7.</span> <span class="toc-text">Use the null condition operator: ?. (available in C# 6 and VB.NET 14):</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">5.</span> <span class="toc-text">NullReference Exception a Visual Basic</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.1.</span> <span class="toc-text">Basic Meaning</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.2.</span> <span class="toc-text">Finding The Cause</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.3.</span> <span class="toc-text">Examples and Remedies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.4.</span> <span class="toc-text">Class Objects / Creating an Instance</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.5.</span> <span class="toc-text">Arrays</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.6.</span> <span class="toc-text">Lists and Collections</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.7.</span> <span class="toc-text">Data Provider Objects</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.8.</span> <span class="toc-text">Object Paths / Nested</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.9.</span> <span class="toc-text">UI Controls</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.10.</span> <span class="toc-text">Visual Basic Forms</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.11.</span> <span class="toc-text">Function Returning Nothing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.12.</span> <span class="toc-text">Poorly Implemented Try/Catch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.13.</span> <span class="toc-text">DBNull is not the same as Nothing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.14.</span> <span class="toc-text">Controls</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.14.1.</span> <span class="toc-text">The DataGridView</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.14.2.</span> <span class="toc-text">Example 2 a Beware of the NewRow</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.15.</span> <span class="toc-text">My.Settings (StringCollection)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">6.</span> <span class="toc-text">Key Points</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- side-bar-ad -->
<ins class="adsbygoogle"
     style="display:block; overflow:hidden;"
     data-ad-client="ca-pub-6300557868920774"
     data-ad-slot="2232545787"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>


  


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/javascript/" title="javascript">javascript<sup>207</sup></a></li>
			
		
			
				<li><a href="/tags/java/" title="java">java<sup>205</sup></a></li>
			
		
			
				<li><a href="/tags/html/" title="html">html<sup>203</sup></a></li>
			
		
			
				<li><a href="/tags/python/" title="python">python<sup>199</sup></a></li>
			
		
			
				<li><a href="/tags/bash/" title="bash">bash<sup>198</sup></a></li>
			
		
			
				<li><a href="/tags/php/" title="php">php<sup>197</sup></a></li>
			
		
			
				<li><a href="/tags/css/" title="css">css<sup>88</sup></a></li>
			
		
			
				<li><a href="/tags/shell/" title="shell">shell<sup>78</sup></a></li>
			
		
			
				<li><a href="/tags/jquery/" title="jquery">jquery<sup>61</sup></a></li>
			
		
			
				<li><a href="/tags/linux/" title="linux">linux<sup>57</sup></a></li>
			
		
			
				<li><a href="/tags/机器学习/" title="机器学习">机器学习<sup>41</sup></a></li>
			
		
			
				<li><a href="/tags/unix/" title="unix">unix<sup>30</sup></a></li>
			
		
			
				<li><a href="/tags/mysql/" title="mysql">mysql<sup>17</sup></a></li>
			
		
			
				<li><a href="/tags/html5/" title="html5">html5<sup>16</sup></a></li>
			
		
			
				<li><a href="/tags/xml/" title="xml">xml<sup>13</sup></a></li>
			
		
			
				<li><a href="/tags/http/" title="http">http<sup>10</sup></a></li>
			
		
			
				<li><a href="/tags/区块链/" title="区块链">区块链<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="https://tracholar.github.io" target="_blank" title="个人博客">个人博客</a>
            
          </li>
        
    </ul>
</div>

  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>

    </div>
    <footer><div id="footer" >
	
	
	<section class="info">
		<p> To be or not to be, that is a question. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		版权所有 © 2018 本站文章未经同意，禁止转载！作者：
		
		<a href="/about" target="_blank" title="zhizi">zhizi</a>
		


		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
